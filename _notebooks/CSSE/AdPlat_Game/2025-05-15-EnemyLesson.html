<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Learn how to make an enemy that follows you around and ends the game when interacting">
  <title>Implementing Enemies into the Game</title>
</head>
<body>

  <article>
    <header>
      <h1>Adding an Enemy That Follows the Player in a JavaScript Game</h1>
      <p><strong>Author:</strong> Zhengji Li</p>
      <p><strong>Categories:</strong> AdPlat</p>
      <p><strong>Course Week:</strong> CSSE Week 17</p>
      <p><strong>Permalink:</strong> <a href="/adplat/EnemyLesson">/adplat/EnemyLesson</a></p>
      <p><strong>Description:</strong> Learn how to make an enemy that follows you around and ends the game when interacting</p>
    </header>

    <blockquote>
      This notebook is designed for learners familiar with JavaScript, basic game loops, and sprite management.
    </blockquote>

    <h2>Game Environment Structure</h2>
    <p>
      This example is built with custom classes like <code>Player</code>, <code>Npc</code>, <code>Collectible</code>, etc. We assume you have a level file like <code>GameLevelEnd.js</code>.
    </p>
    <p>We'll modify this level to include an enemy NPC with basic AI.</p>

    <h2>Step 1: Define the Enemy Sprite</h2>
    <pre><code class="language-javascript">
const sprite_src_enemy = path + "/images/gamify/ederman.png";
const sprite_data_enemy = {
  id: 'Enderman',
  greeting: "You feel a dark presence...",
  src: sprite_src_enemy,
  SCALE_FACTOR: 7,
  ANIMATION_RATE: 0,
  pixels: {height: 256, width: 128},
  INIT_POSITION: { x: width / 2, y: height / 4 },
  orientation: {rows: 1, columns: 1},
  down: {row: 0, start: 0, columns: 1},
  hitbox: { widthPercentage: 0.4, heightPercentage: 0.4 },
  zIndex: 10,
  update: function(players, stopGameLoop) {
    // Follows nearest player
    ...
  }
};
    </code></pre>

    <h3>Enemy AI: Following the Player</h3>
    <h2>Step 2: Follow the Nearest Player</h2>
    <pre><code class="language-javascript">
let nearest = players[0];
let minDist = Infinity;

for (const p of players) {
  const dx = p.x - this.x;
  const dy = p.y - this.y;
  const dist = Math.sqrt(dx*dx + dy*dy);
  if (dist < minDist) {
    minDist = dist;
    nearest = p;
  }
}

// Move toward them
const speed = 1.5;
const dx = nearest.x - this.x;
const dy = nearest.y - this.y;
const angle = Math.atan2(dy, dx);
this.x += Math.cos(angle) * speed;
this.y += Math.sin(angle) * speed;
    </code></pre>

    <h3>Game Over Logic</h3>
    <h2>Step 3: End the Game on Collision</h2>
    <pre><code class="language-javascript">
for (const p of players) {
  if (
    Math.abs(p.x - this.x) < this.width * this.hitbox.widthPercentage &&
    Math.abs(p.y - this.y) < this.height * this.hitbox.heightPercentage
  ) {
    stopGameLoop();
    alert("Game Over! You were caught by the enemy!");
  }
}
    </code></pre>

    <h3>Add Enemy to the Level</h3>
    <h2>Step 4: Include the Enemy in the Level</h2>
    <pre><code class="language-javascript">
this.classes = [
  { class: BackgroundParallax, data: image_data_parallax },
  { class: GamEnvBackground, data: image_data_end },
  { class: Player, data: sprite_data_chillguy },
  { class: Npc, data: sprite_data_tux },
  { class: Collectible, data: sprite_data_eye },
  { class: Player, data: sprite_data_alex },
  { class: Enemy, data: sprite_data_enemy } // Add enemy here
];
    </code></pre>

    <h2>TL;DR</h2>
    <ul>
      <li>An enemy sprite.</li>
      <li>Simple AI to follow the nearest player.</li>
      <li>Collision detection to trigger Game Over.</li>
    </ul>

    <h2>Homework</h2>
    <p>For your homework, implement this enemy system into your actual game. Unlike previous enemy lessons, this enemy will follow the player around instead of traveling along a set path.</p>

    <h3>Requirements:</h3>
    <ol>
      <li>Enemy following player</li>
      <li>Game over when enemy interacts with player</li>
      <li>Make it look fluid</li>
    </ol>
  </article>

</body>
</html>
