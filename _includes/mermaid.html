<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose'
        });
        
        // Convert fenced code blocks to mermaid divs
        document.querySelectorAll('pre code.language-mermaid').forEach((block, index) => {
            const content = block.textContent;
            const wrapper = document.createElement('div');
            wrapper.className = 'mermaid';
            wrapper.id = 'mermaid-' + index;
            wrapper.textContent = content;
            block.parentElement.parentNode.replaceChild(wrapper, block.parentElement);
        });
        
        mermaid.run();
    });
</script>